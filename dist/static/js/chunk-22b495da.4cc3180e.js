(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22b495da"],{"08fb":function(e,t,i){"use strict";i("b528")},"4e82":function(e,t,i){"use strict";var o=i("23e7"),a=i("1c0b"),s=i("7b0b"),r=i("d039"),n=i("a640"),d=[],l=d.sort,c=r((function(){d.sort(void 0)})),u=r((function(){d.sort(null)})),h=n("sort"),p=c||!u||!h;o({target:"Array",proto:!0,forced:p},{sort:function(e){return void 0===e?l.call(s(this)):l.call(s(this),a(e))}})},5534:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("h2",{staticStyle:{"text-align":"center"}},[e._v("发布新课程")]),i("el-steps",{staticStyle:{"margin-bottom":"40px"},attrs:{active:2,"process-status":"wait","align-center":""}},[i("el-step",{attrs:{title:"填写课程基本信息"}}),i("el-step",{attrs:{title:"创建课程大纲"}}),i("el-step",{attrs:{title:"最终发布"}})],1),i("el-button",{attrs:{type:"text"},on:{click:e.openChapterDialog}},[e._v("添加章节")]),i("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),i("el-collapse",e._l(e.myList,(function(t){return i("el-collapse-item",{key:t.id,staticClass:"chapter-item",attrs:{name:t.id}},[i("template",{slot:"title"},[i("p",{staticClass:"chapter-title",staticStyle:{width:"60%"}},[e._v(e._s(t.title))]),i("span",{staticClass:"operation"},[i("el-button",{attrs:{type:"text"},on:{click:function(i){return i.stopPropagation(),e.openVideo(t.id)}}},[e._v("添加小节")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return i.stopPropagation(),e.openEditChapter(t.id)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return i.stopPropagation(),e.removeChapter(t)}}},[e._v("删除")])],1)]),i("ul",{staticClass:"chanpterList videoList"},e._l(t.children,(function(t){return i("li",{key:t.id},[i("p",[e._v(" "+e._s(t.title)+" "),i("span",{staticClass:"acts"},[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.openEditVideo(t.id)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.removeVideo(t.id)}}},[e._v("删除")])],1)])])})),0)],2)})),1),i("el-button",{on:{click:e.previous}},[e._v("上一步")]),i("el-button",{attrs:{disabled:e.saveBtnDisabled,type:"primary"},on:{click:e.next}},[e._v("下一步")]),i("el-dialog",{attrs:{visible:e.dialogChapterFormVisible,title:e.dialogText},on:{"update:visible":function(t){e.dialogChapterFormVisible=t}}},[i("el-form",{attrs:{model:e.chapter,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"章节标题"}},[i("el-input",{model:{value:e.chapter.title,callback:function(t){e.$set(e.chapter,"title",t)},expression:"chapter.title"}})],1),i("el-form-item",{attrs:{label:"章节排序"}},[i("el-input-number",{attrs:{min:0,controlsposition:"\nright"},model:{value:e.chapter.sort,callback:function(t){e.$set(e.chapter,"sort",t)},expression:"chapter.sort"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogChapterFormVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdate}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{visible:e.dialogVideoFormVisible,title:e.videoDialogText,"before-close":e.closeAddVideo},on:{"update:visible":function(t){e.dialogVideoFormVisible=t}}},[i("el-form",{attrs:{model:e.video,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"课时标题"}},[i("el-input",{model:{value:e.video.title,callback:function(t){e.$set(e.video,"title",t)},expression:"video.title"}})],1),i("el-form-item",{attrs:{label:"课时排序"}},[i("el-input-number",{attrs:{min:0,controlsposition:"\nright"},model:{value:e.video.sort,callback:function(t){e.$set(e.video,"sort",t)},expression:"video.sort"}})],1),i("el-form-item",{attrs:{label:"是否免费"}},[i("el-radio-group",{model:{value:e.video.isFree,callback:function(t){e.$set(e.video,"isFree",t)},expression:"video.isFree"}},[i("el-radio",{attrs:{label:!0}},[e._v("免费")]),i("el-radio",{attrs:{label:!1}},[e._v("默认")])],1)],1),i("el-form-item",{attrs:{label:"上传视频"}},[i("el-upload",{staticClass:"upload-demo",attrs:{"on-success":e.handleVodUploadSuccess,"on-remove":e.handleVodRemove,"before-remove":e.beforeVodRemove,"on-exceed":e.handleUploadExceed,"file-list":e.fileList,action:e.BASE_API+"/eduvod/video/uploadAliyunVideo",limit:1}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传视频")]),i("el-tooltip",{attrs:{placement:"right-end"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 最大支持1G，"),i("br"),e._v(" 支持3GP、ASF、AVI、DAT、DV、FLV、F4V、"),i("br"),e._v(" GIF、M2T、M4V、MJ2、MJPEG、MKV、MOV、MP4、"),i("br"),e._v(" MPE、MPG、MPEG、MTS、OGG、QT、RM、RMVB、"),i("br"),e._v(" SWF、TS、VOB、WMV、WEBM 等视频格式上传 ")]),i("i",{staticClass:"el-icon-question"})])],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeAddVideo}},[e._v("取 消")]),i("el-button",{attrs:{disabled:e.saveVideoBtnDisabled,type:"primary"},on:{click:e.saveOrUpdateVideo}},[e._v("确 定")])],1)],1)],1)},a=[],s=(i("4de4"),i("d3b7"),i("b0c0"),i("4e82"),i("5991")),r=i("ce5a"),n={data:function(){return{fileList:[],BASE_API:"http://8.130.115.225:8222",videoDialogText:"",filterText:"",courseId:"",saveBtnDisabled:!1,chapterVideoList:[],dialogChapterFormVisible:!1,dialogVideoFormVisible:!1,video:{title:"",sort:0,isFree:!1,videoSourceId:"",videoOriginalName:""},chapter:{title:"",sort:0},dialogText:"",saveVideoBtnDisabled:!1}},computed:{myList:function(){var e=this;return this.chapterVideoList.filter((function(t){return-1!==t.title.indexOf(e.filterText)}))}},created:function(){this.$route.params&&this.$route.params.id&&(this.courseId=this.$route.params.id,this.getChapterVideo())},methods:{closeAddVideo:function(){var e=this;this.video.id?this.dialogVideoFormVisible=!1:this.video.videoSourceId?this.$confirm("是否中途退出并移除视频？").then((function(){e.dialogVideoFormVisible=!1,e.handleVodRemove()})).catch((function(){})):this.dialogVideoFormVisible=!1},handleVodRemove:function(){var e=this;r["a"].deleteAliyunvod(this.video.videoSourceId).then((function(t){e.$message({type:"success",message:"删除成功！"}),e.fileList=[],e.video.videoSourceId="",e.video.videoOriginalName="",r["a"].updateVideo(e.video).then((function(e){}))}))},beforeVodRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleVodUploadSuccess:function(e,t,i){this.video.videoSourceId=e.data.videoId,this.video.videoOriginalName=t.name},handleUploadExceed:function(){this.$message({type:"warning",message:"想要重新上传视频，请先删除已上传的视频"})},openEditVideo:function(e){var t=this;this.fileList=[],this.videoDialogText="修改小节",r["a"].getVideoInfo(e).then((function(e){console.log(e.data),t.video=e.data.video,t.video.videoOriginalName&&(t.fileList=[{name:t.video.videoOriginalName}]),t.dialogVideoFormVisible=!0}))},removeVideo:function(e){var t=this;this.$confirm("此操作将永久删除该课时, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].deleteVideo(e).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getChapterVideo()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},openVideo:function(e){this.videoDialogText="添加小节",this.video={title:"",sort:0,free:!1,videoSourceId:"",videoOriginalName:""},this.fileList=[],this.dialogVideoFormVisible=!0,this.video.chapterId=e},addVideo:function(){var e=this;this.video.courseId=this.courseId,r["a"].addVideo(this.video).then((function(t){e.dialogVideoFormVisible=!1,e.$message({type:"success",message:"添加成功!"}),e.getChapterVideo()}))},updateVideo:function(){var e=this;this.video.title?r["a"].updateVideo(this.video).then((function(t){e.dialogVideoFormVisible=!1,e.$message({type:"success",message:"修改成功!"}),e.getChapterVideo()})):this.$message({type:"warning",message:"请输入小节标题!"})},saveOrUpdateVideo:function(){this.video.id?this.updateVideo():this.addVideo()},removeChapter:function(e){var t=this;e.children.length>0?this.$confirm("此操作会删除该章节和其小节,请谨慎操作，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){s["a"].deleteAllChapter(e.id).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getChapterVideo()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})})):this.$confirm("此章节尚未有子章节，可以放心删除，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"].deleteChapter(e.id).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getChapterVideo()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},updateChapter:function(){var e=this;""!=this.chapter.title?s["a"].updateChapter(this.chapter).then((function(t){e.dialogChapterFormVisible=!1,e.$message({message:"修改章节成功！",type:"success"}),e.getChapterVideo()})):this.$message({message:"章节标题不能为空！",type:"warning"})},openEditChapter:function(e){var t=this;this.dialogText="修改章节",this.dialogChapterFormVisible=!0,s["a"].getChapter(e).then((function(e){t.chapter=e.data.chapter}))},openChapterDialog:function(){this.dialogText="添加章节",this.chapter.title="",this.chapter.sort=0,this.chapter.id="",this.dialogChapterFormVisible=!0},addChapter:function(){var e=this;this.chapter.courseId=this.courseId,""!=this.chapter.title?s["a"].addChapter(this.chapter).then((function(t){e.dialogChapterFormVisible=!1,e.$message({message:"添加章节成功！",type:"success"}),e.getChapterVideo()})):this.$message({message:"章节标题不能为空！",type:"warning"})},saveOrUpdate:function(){this.chapter.id?this.updateChapter():this.addChapter()},getChapterVideo:function(){var e=this;s["a"].getAllChapterVideo(this.courseId).then((function(t){e.chapterVideoList=t.data.allChapterVideo}))},previous:function(){this.$router.push("/course/info/"+this.courseId)},next:function(){this.$router.push("/course/publish/"+this.courseId)}}},d=n,l=(i("08fb"),i("2877")),c=Object(l["a"])(d,o,a,!1,null,"5cf999a6",null);t["default"]=c.exports},5991:function(e,t,i){"use strict";var o=i("b775");t["a"]={getAllChapterVideo:function(e){return Object(o["a"])({url:"/eduservice/chapter/getChapterVideo/".concat(e),method:"get"})},addChapter:function(e){return Object(o["a"])({url:"/eduservice/chapter/addChapter",method:"post",data:e})},getChapter:function(e){return Object(o["a"])({url:"/eduservice/chapter/getChapterInfo/".concat(e),method:"get"})},updateChapter:function(e){return Object(o["a"])({url:"/eduservice/chapter/updateChapter",method:"post",data:e})},deleteChapter:function(e){return Object(o["a"])({url:"/eduservice/chapter/".concat(e),method:"delete"})},deleteAllChapter:function(e){return Object(o["a"])({url:"/eduservice/chapter/deleteAllChapter/".concat(e),method:"delete"})}}},b528:function(e,t,i){},ce5a:function(e,t,i){"use strict";var o=i("b775");t["a"]={addVideo:function(e){return Object(o["a"])({url:"/eduservice/video/addVideo",method:"post",data:e})},deleteVideo:function(e){return Object(o["a"])({url:"/eduservice/video/".concat(e),method:"delete"})},getVideoInfo:function(e){return Object(o["a"])({url:"/eduservice/video/getVideoInfo/".concat(e),method:"get"})},updateVideo:function(e){return Object(o["a"])({url:"/eduservice/video/updateVideo",method:"post",data:e})},deleteAliyunvod:function(e){return Object(o["a"])({url:"/eduvod/video/removeAlyVideo/".concat(e),method:"delete"})}}}}]);